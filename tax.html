<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>香港薪俸稅計算機 (詳細版 - 非官方)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 800px;
            background-color: #ffffff;
            padding: 25px 35px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #003366;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h1 { font-size: 1.8em; }
        h2 { font-size: 1.4em; margin-top: 30px; }
        .disclaimer {
            background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;
            padding: 15px; border-radius: 5px; text-align: center; margin-bottom: 25px;
        }
        .form-group {
            margin-bottom: 18px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }
        .form-group label, .form-group .label-text {
            flex: 1 1 350px; /* Increased label width */
            font-weight: 600;
            margin-right: 15px;
            line-height: 1.4;
        }
        .form-group input, .form-group select {
            flex: 1 1 300px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1em;
        }
        .checkbox-group label {
            flex: unset;
            margin-right: 10px;
        }
        .checkbox-group input {
            flex: unset;
            width: auto;
        }
        button {
            width: 100%;
            padding: 15px;
            background-color: #0056b3;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }
        button:hover { background-color: #004494; }
        .result {
            margin-top: 30px; background-color: #e2f0ff; padding: 20px;
            border-radius: 5px; border-left: 5px solid #0056b3;
        }
        .result h2 { border: none; text-align: left; }
        .result p { font-size: 1.1em; margin: 10px 0; }
        .result span, .final-amount { font-weight: bold; color: #d9534f; }
        .final-amount { font-size: 1.3em; }
    </style>
</head>
<body>

<div class="container">
    <div class="disclaimer">
        ⚠️ <strong>注意：</strong> 此為非官方網頁範本，僅供教學及估算參考。計算結果可能與實際稅款有出入，請以稅務局的最終評稅為準。
    </div>

    <h1>薪俸稅計算機</h1>

    <h2>基本資料</h2>
    <div class="form-group">
        <label class="label-text">課 税 年 度：</label>
        <input type="text" value="2025/26" disabled>
    </div>
     <div class="form-group">
        <label for="maritalStatus">婚 姻 狀 況：</label>
        <select id="maritalStatus">
            <option value="132000" data-is-married="false">單 身 / 分 居 / 離 婚 / 喪 偶</option>
            <option value="264000" data-is-married="true">已 婚 (配偶沒有應課稅入息)</option>
        </select>
    </div>

    <h2>第一部分：入息</h2>
    <div class="form-group">
        <label for="totalIncome">課稅年度的總入息 (HK$)</label>
        <input type="number" id="totalIncome" placeholder="薪金、花紅、津貼等總和">
    </div>
    <div class="form-group">
        <label for="rentalValue">所 有 獲 僱 主 或 相 聯 公 司 提 供 居 所 的 租 值 (HK$)</label>
        <input type="number" id="rentalValue" placeholder="請直接輸入租值">
    </div>

    <h2>第二部分：扣除項目</h2>
    <div class="form-group">
        <label for="expenses">支出及開支 (HK$)</label>
        <input type="number" id="expenses" placeholder="例如專業團體會費">
    </div>
    <div class="form-group">
        <label for="selfEducation">個人進修開支 (上限 $100,000)</label>
        <input type="number" id="selfEducation" placeholder="0">
    </div>
    <div class="form-group">
        <label for="donations">認可慈善捐款 (HK$)</label>
        <input type="number" id="donations" placeholder="0">
    </div>
    <div class="form-group">
        <label for="mpfMandatory">強積金強制性供款 (上限 $18,000)</label>
        <input type="number" id="mpfMandatory" placeholder="0">
    </div>
    <div class="form-group">
        <label for="mpfVoluntary">可扣稅自願性供款及年金 (合計上限 $60,000)</label>
        <input type="number" id="mpfVoluntary" placeholder="0">
    </div>
    <div class="form-group">
        <label for="healthInsurance">合資格醫療保險保費 (每名受保人上限 $8,000)</label>
        <input type="number" id="healthInsurance" placeholder="所有受保人總額">
    </div>
     <div class="form-group">
        <label for="fertility">輔助生育服務開支 (上限 $100,000)</label>
        <input type="number" id="fertility" placeholder="0">
    </div>
    <div class="form-group">
        <label for="rent">住宅租金扣除 (上限 $100,000 或 $120,000)</label>
        <input type="number" id="rent" placeholder="0">
    </div>
    <div class="form-group">
        <label for="homeInterest">居所貸款利息 (上限 $100,000 或 $120,000)</label>
        <input type="number" id="homeInterest" placeholder="0">
    </div>
     <div class="form-group">
        <label for="elderlyCare">長者住宿照顧開支 (每名長者上限 $100,000)</label>
        <input type="number" id="elderlyCare" placeholder="0">
    </div>

    <h2>第三部分：免稅額</h2>
    <div class="form-group checkbox-group">
        <label for="isSingleParent">申請單親免稅額?</label>
        <input type="checkbox" id="isSingleParent">
    </div>
    <div class="form-group">
        <label for="childrenBorn">供養子女人數 (在課稅年度內出生)</label>
        <input type="number" id="childrenBorn" placeholder="0">
    </div>
    <div class="form-group">
        <label for="childrenOther">供養子女人數 (在其他課稅年度出生)</label>
        <input type="number" id="childrenOther" placeholder="0">
    </div>
    <div class="form-group">
        <label for="dependentSiblings">供養兄弟姊妹人數</label>
        <input type="number" id="dependentSiblings" placeholder="0">
    </div>
    <div class="form-group">
        <label for="parents60">供養父母/祖父母 (60歲或以上)</label>
        <input type="number" id="parents60" placeholder="0">
    </div>
    <div class="form-group checkbox-group">
        <label for="parents60LiveWith">...當中全年同住人數</label>
        <input type="number" id="parents60LiveWith" placeholder="0">
    </div>
    <div class="form-group">
        <label for="parents55">供養父母/祖父母 (55-59歲)</label>
        <input type="number" id="parents55" placeholder="0">
    </div>
    <div class="form-group checkbox-group">
        <label for="parents55LiveWith">...當中全年同住人數</label>
        <input type="number" id="parents55LiveWith" placeholder="0">
    </div>
    <div class="form-group checkbox-group">
        <label for="isDisabledPerson">申請個人傷殘免稅額?</label>
        <input type="checkbox" id="isDisabledPerson">
    </div>
    <div class="form-group">
        <label for="disabledDependants">傷殘受養人數目</label>
        <input type="number" id="disabledDependants" placeholder="0">
    </div>


    <button onclick="calculateTax()">計算應繳稅款</button>

    <div class="result" id="result" style="display:none;">
        <h2>稅款計算結果</h2>
        <p>總入息 (包括居所租值): <span id="resTotalIncome"></span></p>
        <p>總扣除額: <span id="resTotalDeductions"></span></p>
        <p>總免稅額: <span id="resTotalAllowances"></span></p>
        <p>應課稅入息實額: <span id="resNetChargeableIncome"></span></p>
        <hr>
        <p>按累進稅率計算的稅款: <span id="resProgressiveTax"></span></p>
        <p>按標準稅率計算的稅款: <span id="resStandardTax"></span></p>
        <hr>
        <p><strong>最終應繳稅款 (取較低者): <span class="final-amount" id="resFinalTax"></span></strong></p>
    </div>
</div>

<script>
    function p(id) {
        return parseFloat(document.getElementById(id).value) || 0;
    }
    function c(id) {
        return document.getElementById(id).checked;
    }

    function calculateTax() {
        // === 1. 計算總入息 (Total Assessable Income) ===
        const totalIncome = p('totalIncome');
        const rentalValue = p('rentalValue');
        const assessableIncome = totalIncome + rentalValue;

        // === 2. 計算總扣除額 (Total Deductions) ===
        const expenses = p('expenses');
        const donationLimit = Math.max(0, assessableIncome - expenses) * 0.35;
        const donations = Math.min(p('donations'), donationLimit);
        const selfEducation = Math.min(p('selfEducation'), 100000);
        const mpfMandatory = Math.min(p('mpfMandatory'), 18000);
        const mpfVoluntary = Math.min(p('mpfVoluntary'), 60000);
        const healthInsurance = p('healthInsurance');
        const fertility = Math.min(p('fertility'), 100000);
        
        const childrenBornCount = p('childrenBorn');
        const rentInterestLimit = childrenBornCount > 0 ? 120000 : 100000;
        const rent = Math.min(p('rent'), rentInterestLimit);
        const homeInterest = Math.min(p('homeInterest'), rentInterestLimit);

        const elderlyCare = p('elderlyCare');

        const totalDeductions = expenses + selfEducation + donations + mpfMandatory + mpfVoluntary + healthInsurance + fertility + rent + homeInterest + elderlyCare;
        
        // === 3. 計算總免稅額 (Total Allowances) ===
        const maritalStatusElement = document.getElementById('maritalStatus');
        const isMarried = maritalStatusElement.options[maritalStatusElement.selectedIndex].dataset.isMarried === 'true';
        const maritalAllowance = p('maritalStatus');
        const singleParentAllowance = c('isSingleParent') && !isMarried ? 132000 : 0;
        
        const childAllowance = (childrenBornCount * 260000) + (p('childrenOther') * 130000);
        const dependentSiblingsAllowance = p('dependentSiblings') * 37500;

        const parents60 = p('parents60');
        const parents60LiveWith = Math.min(parents60, p('parents60LiveWith'));
        const parents60Not